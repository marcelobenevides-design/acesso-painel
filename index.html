<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Indo para o Painel</title>
  <meta name="robots" content="noindex">
  <style>
    body{font-family:system-ui,Arial,sans-serif;margin:24px}
    .msg{opacity:.8}
  </style>
</head>
<body>
  <p class="msg">
    Redirecionando para o painel… Se não abrir automaticamente,
    <a id="fallback" href="#">clique aqui</a>.
  </p>

  <!-- ping invisível para registrar o clique -->
  <img id="logger" src="" alt="" style="display:none" referrerpolicy="no-referrer">

  <script>
    // ====== CONFIGURÁVEIS ======
    // Painel de destino (Looker)
    const DESTINO = "https://lookerstudio.google.com/reporting/c944febf-5dec-423b-a4f4-364009fb0ce0/page/ucXUF";
    // URL do seu Web App (/exec) SEM "/a/..."
    const WEBAPP  = "https://script.google.com/macros/s/AKfycbytVTNs4p5lycqF2YHatY50rspFfYYnn7gvYsSPXL9aJKL-PbpgpEmFA6V_mWa0ma1L/exec";
    // Campos que deseja registrar
    const painel  = "Painel_Logistico";
    const user    = "Marcelo"; // ajuste se quiser registrar outro identificador

    // ====== NÃO ALTERAR ABAIXO ======
    // 1) dispara o log com cache-buster
    const qs = new URLSearchParams({ painel, user, t: Date.now().toString() });
    const img = document.getElementById("logger");
    img.src = WEBAPP + "?" + qs.toString();

    // 2) link de fallback
    document.getElementById("fallback").href = DESTINO;

    // 3) redireciona só após o ping concluir (onload/onerror) OU 300ms
    let done = false;
    function go(){
      if (done) return; done = true;
      try { window.top.location.href = DESTINO; }
      catch(e){ window.location.href = DESTINO; }
    }
    img.addEventListener("load", go, { once:true });
    img.addEventListener("error", go, { once:true });
    setTimeout(go, 300); // fallback de tempo
  </script>
</body>
</html>
